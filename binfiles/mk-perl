#!/usr/bin/env zsh

: ${USRLOCAL:=/usr/local}
: ${BLDROOT:=$USRLOCAL/build}

install=
snapshot=
zparseopts -D i=install -install=install s=snapshot -snapshot=snapshot

pkgname=perl
scm_opts=
if [[ $# == 0 ]]; then
  set $pkgname
  scm_opts=--update
fi

cd $(SRCROOT=$BLDROOT GetSource --src=$BLDROOT $scm_opts "$1")
prefix=$USRLOCAL
[[ -n $snapshot ]] && prefix=$prefix/${PWD:t}
./Configure -Dprefix=$prefix -Dusedevel -Dcf_email=ethersoft@gmail.com -des

make
make test
[[ -n $install ]] && make install

# Local Variables:
# mode: shell-script
# sh-basic-offset: 2
# sh-indentation: 2
# indent-tabs-mode: nil
# End:
