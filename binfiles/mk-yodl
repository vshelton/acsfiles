
# Get, build and install yodl.

# Like configure's --prefix argument, but not absolute
# because of a quirk in icmake's installation procedures.
: ${PREFIX:=opt}
: ${SRCROOT:=/$PREFIX/src}

: ${ICMAKE_VER:=7.16.00}
: ${ICMAKE_TARBALL:=icmake_${ICMAKE_VER}.orig.tar.gz}
: ${YODL_VER:=3.00.0}
: ${YODL_TARBALL:=yodl_${YODL_VER}.orig.tar.gz}

# Get, build and install icmake, a prerequisite for yodl.
cd ${SRCROOT}
wget -q -O ${ICMAKE_TARBALL} http://sourceforge.net/projects/icmake/files/icmake/${ICMAKE_VER}/${ICMAKE_TARBALL}/download
tar xf ${ICMAKE_TARBALL}
cd ./icmake-${ICMAKE_VER}
perl -pi.orig -e "s@usr/@${PREFIX}/@;s@etc/icmake@${PREFIX}/etc/icmake@" INSTALL.im
perl -pi.orig -e 's@etc/icmake@\${CONFDIR}@' icm_install
./icm_bootstrap /
./icm_install all

# Get, build and install yodl.
cd ${SRCROOT}
wget -q -O ${YODL_TARBALL} http://sourceforge.net/projects/yodl/files/yodl/${YODL_VER}/${YODL_TARBALL}/download    
tar xf ${YODL_TARBALL}
cd ./yodl-${YODL_VER}
perl -pi.orig -e "s@/usr/bin/icmake@/${PREFIX}/bin/icmake@" build
perl -pi.orig -e "s@\"/usr\"\;@\"/${PREFIX}\"\;@" INSTALL.im
./build programs
./build macros
./build install yodl /
./build install macros /

# Local Variables:
# mode: shell-script
# sh-indentation: 2
# indent-tabs-mode: nil
# End:
